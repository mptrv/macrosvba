' Parte do Instalador de Métodos Automáticos
' ===== == ========== == ======= ===========
' Complementos da instalação.
'
' Métodos Automáticos são módulos que fazem parte do Sistema Horários.

' ---------------------------------------------------
' Rotinas e Funções

Public oWS
Public dir_origem
Public dir_dest

Private Sub CriarAtalhos()

	area_trab = oWS.SpecialFolders("Desktop")

	sLinkFile = area_trab & "\Construção Grade Horária.lnk"

	Set oLink = oWS.CreateShortcut(sLinkFile)
		oLink.TargetPath = dir_dest & "\macros\construcao-grade_horaria.xlsm"
		oLink.Arguments = ""
		oLink.Description = "Construção Grade Horária - Sistema de Horários"
		oLink.HotKey = "ALT+CTRL+G"
		oLink.IconLocation = dir_dest & "\imagens\cgh.ico"
		oLink.WindowStyle = "1"
		oLink.WorkingDirectory = dir_dest & "\macros"
	oLink.Save
	Set oLink = nothing

	sLinkFile = area_trab & "\Consulta Sistema Horários.lnk"

	Set oLink = oWS.CreateShortcut(sLinkFile)
		oLink.TargetPath = dir_dest & "\macros\consulta-sistema-horarios-oficial.accdr"
		oLink.Arguments = ""
		oLink.Description = "Consulta Sistema Horários - Sistema de Horários"
		oLink.HotKey = "ALT+CTRL+C"
		oLink.IconLocation = dir_dest & "\imagens\csh.ico"
		oLink.WindowStyle = "1"
		oLink.WorkingDirectory = dir_dest & "\macros"
	oLink.Save
	Set oLink = nothing

End Sub

Private Sub InstalarSQLNCLI()	

	Set oFS = WScript.CreateObject("Scripting.FileSystemObject")

	dirsystem = oWS.Environment("PROCESS").Item("SYSTEMROOT") & "\System"

	if not (oFS.FileExists(dirsystem & "\sqlncli10.dll") or _
			oFS.FileExists(dirsystem & "32\sqlncli10.dll")) then

		oWS.Run "msiexec /quiet /i " & dir_origem & "\redistribuiveis\sqlncli.msi"

	end if			  	

End Sub

' ---------------------------------------------------
' Programa Principal

' Definições de variáveis globais.

Set oWS = WScript.CreateObject("WScript.Shell")

dir_origem = oWS.Environment("PROCESS").Item("DIR_ORIGEM")
dir_dest = oWS.Environment("PROCESS").Item("DIR_DEST")

' Instalações

CriarAtalhos

InstalarSQLNCLI

' Mensagem de conclusão.

MsgBox _
		  "Instalação Concluída!" & vblf & vblf & _
		  "Os atalhos foram criados na área de trabalho.", _
		  vbOKOnly + vbInformation, _
		  "Métodos Automáticos - Sistema Horários"

Set oWS = nothing
